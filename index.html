<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒã‚ºäºˆæ¸¬ãƒ„ãƒ¼ãƒ«</title>
  <style>/* æ—¢å­˜ã‚¹ã‚¿ã‚¤ãƒ«ãã®ã¾ã¾ */</style>
</head>
<body>
  <div class="container">
    <h1>ğŸš€ ãƒã‚ºäºˆæ¸¬ãƒ„ãƒ¼ãƒ«</h1>
    <input id="text" placeholder="æŠ•ç¨¿ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...">
    <button onclick="predict()">äºˆæ¸¬ã™ã‚‹</button>
    <p id="result"></p>
  </div>

  <script>
    const BEARER_TOKEN = "AAAAAAAAAAAAAAAAAAAAAMaizwEAAAAAtatXubBvuPNZEyzetE3FuKdyFlg=hDNkdxgrVDonzjkifrbPDaqjURysV0o0OAhZwpSmJ9Bk1X31QT";

    async function fetchTrends() {
      try {
        const response = await fetch("https://api.twitter.com/2/tweets/search/recent?query=lang:ja -is:retweet&tweet.fields=public_metrics", {
          headers: {
            "Authorization": `Bearer ${BEARER_TOKEN}`
          }
        });
        if (!response.ok) {
          throw new Error(`HTTPã‚¨ãƒ©ãƒ¼: ${response.status}`);
        }
        const data = await response.json();
        console.log("APIãƒ¬ã‚¹ãƒãƒ³ã‚¹:", data); // ãƒ‡ãƒãƒƒã‚°ç”¨
        // ä»®ãƒˆãƒ¬ãƒ³ãƒ‰ï¼ˆå®Ÿéš›ã¯dataã‹ã‚‰æŠ½å‡ºï¼‰
        return ["#æ˜¥ä¼‘ã¿", "#æ¡œ"];
      } catch (error) {
        console.error("ãƒˆãƒ¬ãƒ³ãƒ‰å–å¾—ã‚¨ãƒ©ãƒ¼:", error);
        return ["#æ˜¥ä¼‘ã¿", "æ¡œ"];
      }
    }

    async function predict() {
      let text = document.getElementById("text").value;
      let likes = 50;
      let tips = "";

      if (!text) {
        document.getElementById("result").innerHTML = "âš ï¸ æŠ•ç¨¿ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„";
        return;
      }

      const trendingWords = await fetchTrends();
      trendingWords.forEach(word => {
        if (text.includes(word)) {
          likes += 30;
          tips += `ãƒˆãƒ¬ãƒ³ãƒ‰ã€Œ${word}ã€ã‚’æ´»ç”¨ã—ã¦ã¾ã™ã­ï¼ `;
        }
      });

      if (text.includes("ç„¡æ–™") || text.includes("ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆ")) likes += 40;
      if (text.length < 15) likes += 30;
      if (text.includes("#")) likes += 15;
      else tips += "ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ã‚’åŠ ãˆã‚‹ã¨ãƒã‚ºã‚Šã‚„ã™ã„ã§ã™ã‚ˆï¼";

      let result = document.getElementById("result");
      result.innerHTML = `ğŸ”¥ äºˆæ¸¬ã„ã„ã­æ•°: ${likes}<br>ğŸ’¡ æ”¹å–„ææ¡ˆ: ${tips || "Good!"}`;
      result.classList.remove("show");
      setTimeout(() => result.classList.add("show"), 300);
    }
  </script>
</body>
</html>